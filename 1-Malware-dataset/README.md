# Malware dataset with 7'000 provenance graphs

The EagleEye research work was tested on a novel dataset collected by Acronis Research. The dataset consists of 12k benign and malicious process provenance graphs.

To encourage further academic research, we release the *malicious* part of the dataset. You can download the dataset here:

[Download malware dataset from Google Drive](https://drive.google.com/file/d/1JRHBh_-hcuqxyniEb3lKkv97DLQP7qj3/view?usp=sharing)

## Explore the dataset

The Python file [analyze_dataset.py](analyze_dataset.py) showcases how to open and explore graphs from the malware dataset.

How to run the demo script:

- Navigate to the repository root directory
- Use Python 3.12
- Create a pip virtual environment:
```
python -m venv .venv
source ./.venv/bin/activate
```
- Install required Python libraries:
```
pip install -r ./requirements.txt
```
- Analyze the malware dataset:
```
python ./1-Malware-dataset/analyze_dataset.py
```

## More details about the dataset

The dataset contains ~7k provenance graphs. Each graph is stored in one file. The file names contain the hash of the malware sample.

As mentioned in the paper, we downloaded malware from VirusTotal, and ran the samples in a modified CAPE Sandbox. We preprocessed the resulting system logs and turned them into process provenance graphs.

Each file in the dataset contains a JSON representation of the process provenance graph. You can use any graph library, like `networkx`, to process the graphs programmatically.

The JSON files contain the graph structure of each malware sample. Process events point to a number of children events, which are the behavior events triggered by the new process. Other events like file access, socket events, and registry events are leaves in the graph, and don't contain any child events.

Each node in JSON has a set of **raw** features, plus a node ID.

## Raw features

**Process events** have the following raw features:

- `event_type`: Is always `si_create_process`.
- `parent_process_id`: The ID of the parent process.
- `child_process_id`: The ID of the new process.
- `image_filename`: The executable file name and path.
- `cmdline`: The full command line string used to start the process. This includes command flags.
- `timestamp`: A unix timestamp.

**File access events** have the following raw features:

- `event_type`: Is always `si_create_file`.
- `object_name`: The full file name and path.
- `open_options`: 
- `open_access_flags`:
- `create_file_disposition`: 
- `thread_uid`: The unique ID of the thread.
- `timestamp`: A unix timestamp.

**Socket events** have the following raw features:

- `event_type`: Is always `etw_tcp_send_ipv4`.
- `saddr`: The source IP address.
- `daddr`: The destination IP address.
- `sport`: The source port.
- `dport`: The destination port.
- `size`: The number of bytes transmitted.
- `seqnum`:
- `pid`:
- `connid`:
- `timestamp`: A unix timestamp.

**Registry events** have the following raw features:

- `event_type`: Is always `si_set_value_key`.
- `object_name`: The full registry key name and path.
- `object_size`:
- `object_info.blob_size`:
- `object_info.blob_dump`:
- `object_info.blob_type`:
- `thread_uid`: The unique ID of the thread.
- `timestamp`: A unix timestamp.
